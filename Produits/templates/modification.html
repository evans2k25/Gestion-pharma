{% load widget_tweaks %}

<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Formulaire de modification</title>
    <link
        href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css"
        rel="stylesheet"
    />
    <style>
        body {
            background-color: #f8f9fa;
            color: #000;
        }
        .form-container {
            max-width: 800px;
            margin: 50px auto;
            padding: 20px;
            background: white;
            border-radius: 10px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
        }
        .dark-mode {
            background-color: #343a40;
            color: #fff;
        }
        .dark-mode header {
            background-color: #212529 !important;
            color: #fff !important;
        }
    </style>
</head>
<body>
    <header class="p-3 bg-light text-dark d-flex justify-content-between">
        <h1>-----XXXXXX----</h1>
        <button class="btn btn-dark" id="themeToggle">Mode Sombre</button>
    </header>

    <div class="container py-5">
        <div class="form-container shadow-lg p-4 bg-white">
            
    
            <form method="POST" class="row g-3" enctype="multipart/form-data">

                <h2 class="text-center mb-4">Modification du Produit</h2>
                {% csrf_token %}
                
                <!-- Nom du produit -->
                <div class="col-md-6">
                    <label for="{{ form.name.id_for_label }}" class="form-label">Nom du produit</label>
                    <input type="text" name="name" id="name" class="form-control" 
                               value="{{ produit.name }}" required>
                    {% if form.name.errors %}
                        <div class="invalid-feedback d-block">
                            {{ form.name.errors.0 }}
                        </div>
                    {% endif %}
                </div>
    
                <!-- Catégorie -->
                <div class="col-md-6">
                    <label for="{{ form.category.id_for_label }}" class="form-label">Catégorie</label>
                        <select name="category" id="category" class="form-select" required>
                         <option value="">Sélectionnez une catégorie</option>
                         {% for category in categories %}
                         <option value="{{ category.id }}" {% if form.category.value == category.pk %}selected{% endif %}>
                         {{ produit.category.name }}
                         </option>
                        {% endfor %}
                            </select>
                                {% if form.category.errors %}
                                <div class="invalid-feedback d-block">
                                   {{ form.category.errors.0 }}
                           </div>
                        {% endif %}

                </div>
    
                <!-- Prix Unitaire -->
                <div class="col-md-6">
                    <label for="{{ form.price.id_for_label }}" class="form-label">Prix Unitaire </label>
                    
                    <input type="number" name="price" id="price" class="form-control" 
                               value="{{ produit.price }}" step="0.01" required>
                    {% if form.price.errors %}
                        <div class="invalid-feedback d-block">
                            {{ form.price.errors.0 }}
                        </div>
                    {% endif %}
                </div>
    
                <!-- Quantité -->
                <div class="col-md-6">
                    <label for="{{ form.quantite.id_for_label }}" class="form-label">Quantité</label>
                    
                    <input type="number" name="quantite" id="quantite" class="form-control" 
                               value="{{ produit.quantite }}" required>
                    {% if form.quantite.errors %}
                        <div class="invalid-feedback d-block">
                            {{ form.quantite.errors.0 }}
                        </div>
                    {% endif %}
                </div>
    
                <!-- Date d'expiration -->
                <div class="col-md-6">
                    <label for="{{ form.date_expiration.id_for_label }}" class="form-label">Date d'expiration</label>
                    
                    <input type="date" name="date_expiration" id="date_expiration" class="form-control" 
                               value="{{ produit.date_expiration }}" required>
                    {% if form.date_expiration.errors %}
                        <div class="invalid-feedback d-block">
                            {{ form.date_expiration.errors.0 }}
                        </div>
                    {% endif %}
                </div>
    
                <!-- Image -->
                <div class="col-md-6">
                    <label for="{{ form.image.id_for_label }}" class="form-label">Image</label>
                    
                    <input type="file" name="image" id="image" class="form-control">

                   

                    {% if form.image.errors %}
                        <div class="invalid-feedback d-block">
                            {{ form.image.errors.0 }}
                        </div>
                    {% endif %}
    
                    {% if produit.image %}
                        <div class="mt-2">
                            <img src="{{ produit.image.url }}" alt="Image actuelle" class="img-thumbnail" width="100">
                        </div>
                    {% endif %}
                </div>
    
                <!-- Description -->
                <div>
                  
                    <label for="{{ form.description.id_for_label }}" class="form-label">Description</label>
                
                    <textarea name="description" id="description" class="form-control" rows="3" required>{{ produit.description }}</textarea>
                    
                    {% if form.description.errors %}
                        <div class="invalid-feedback d-block">
                            {{ form.description.errors.0 }}
                        </div>
                    {% endif %}
                </div>
    
                <!-- Boutons -->
                <div class="col-12 text-center mt-4">
                    <button type="submit" class="btn btn-primary px-5">Mettre à jour</button>
                    <a href="{% url 'home' %}" class="btn btn-secondary px-5 ms-2">Annuler</a>
                </div>
            </form>
        </div>
    </div>
    
    

    <script>
        document.addEventListener("DOMContentLoaded", function () {
            const themeToggle = document.getElementById("themeToggle");
            const currentTheme = localStorage.getItem("theme");

            if (currentTheme === "dark") {
                document.body.classList.add("dark-mode");
                themeToggle.textContent = "Mode Clair";
                themeToggle.classList.replace("btn-dark", "btn-light");
            }

            themeToggle.addEventListener("click", function () {
                document.body.classList.toggle("dark-mode");
                const isDarkMode = document.body.classList.contains("dark-mode");
                themeToggle.textContent = isDarkMode ? "Mode Clair" : "Mode Sombre";
                themeToggle.classList.toggle("btn-dark", !isDarkMode);
                themeToggle.classList.toggle("btn-light", isDarkMode);
                localStorage.setItem("theme", isDarkMode ? "dark" : "light");
            });
        });
    </script>
</body>
</html>
